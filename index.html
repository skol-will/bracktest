<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Simple Bracket Test</title>
<style>
  body {
    background-color: #121212;
    color: white;
    font-family: Arial, sans-serif;
    margin: 0; padding: 20px;
    overflow-x: auto;
  }
  .bracket-container {
    display: flex;
    gap: 60px;
    align-items: center;
    min-width: 900px;
  }
  .round {
    display: flex;
    flex-direction: column;
    gap: 40px;
    min-width: 180px;
  }
  .round h2 {
    text-align: center;
    margin-bottom: 10px;
  }
  .matchup {
    display: flex;
    flex-direction: column;
    gap: 10px;
    position: relative;
  }
  .match-label {
    text-align: center;
    font-size: 14px;
    margin-bottom: 4px;
  }
  .teams {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }
  .team {
    background: #222;
    border-radius: 5px;
    cursor: pointer;
    padding: 8px 12px;
    width: 144px;
    height: 40px;
    line-height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
    transition: background-color 0.2s, box-shadow 0.2s;
  }
  .team.selected {
    background-color: #1e90ff;
    box-shadow: 0 0 10px #1e90ff;
  }
  .team.disabled {
    opacity: 0.4;
    cursor: default;
  }
  .champion {
    margin-top: 40px;
    text-align: center;
    font-size: 18px;
    font-weight: bold;
    border: 2px solid #1e90ff;
    padding: 12px 20px;
    border-radius: 8px;
    min-width: 180px;
  }
</style>
</head>
<body>

<div class="bracket-container">
  <div class="round" id="divisional">
    <h2>Divisional</h2>
    <div class="matchup" data-match="1">
      <div class="match-label">Match 1</div>
      <div class="teams">
        <div class="team" data-round="divisional" data-match="1" data-team="1">Team 1</div>
        <div class="team" data-round="divisional" data-match="1" data-team="2">Team 2</div>
      </div>
    </div>
    <div class="matchup" data-match="2">
      <div class="match-label">Match 2</div>
      <div class="teams">
        <div class="team" data-round="divisional" data-match="2" data-team="3">Team 3</div>
        <div class="team" data-round="divisional" data-match="2" data-team="4">Team 4</div>
      </div>
    </div>
    <div class="matchup" data-match="3">
      <div class="match-label">Match 3</div>
      <div class="teams">
        <div class="team" data-round="divisional" data-match="3" data-team="5">Team 5</div>
        <div class="team" data-round="divisional" data-match="3" data-team="6">Team 6</div>
      </div>
    </div>
    <div class="matchup" data-match="4">
      <div class="match-label">Match 4</div>
      <div class="teams">
        <div class="team" data-round="divisional" data-match="4" data-team="7">Team 7</div>
        <div class="team" data-round="divisional" data-match="4" data-team="8">Team 8</div>
      </div>
    </div>
  </div>

  <div class="round" id="conference">
    <h2>Conference</h2>
    <div class="matchup" data-match="1">
      <div class="match-label">Match 1</div>
      <div class="teams">
        <div class="team disabled" data-round="conference" data-match="1" data-team="">Select Winner</div>
        <div class="team disabled" data-round="conference" data-match="1" data-team="">Select Winner</div>
      </div>
    </div>
    <div class="matchup" data-match="2">
      <div class="match-label">Match 2</div>
      <div class="teams">
        <div class="team disabled" data-round="conference" data-match="2" data-team="">Select Winner</div>
        <div class="team disabled" data-round="conference" data-match="2" data-team="">Select Winner</div>
      </div>
    </div>
  </div>

  <div class="round" id="championship">
    <h2>Championship</h2>
    <div class="matchup" data-match="1">
      <div class="match-label">Match 1</div>
      <div class="teams">
        <div class="team disabled" data-round="championship" data-match="1" data-team="">Select Winner</div>
        <div class="team disabled" data-round="championship" data-match="1" data-team="">Select Winner</div>
      </div>
    </div>
  </div>
</div>

<div class="champion" id="champion">No Champion Selected</div>

<script>
  // Data structure to hold selections
  const bracket = {
    divisional: {
      1: ['1', '2'],
      2: ['3', '4'],
      3: ['5', '6'],
      4: ['7', '8']
    },
    conference: {
      1: ['', ''],
      2: ['', '']
    },
    championship: {
      1: ['', '']
    },
    champion: ''
  };

  // Update matchup display for a round & match
  function updateMatchup(round, match, teams) {
    const matchup = document.querySelector(`#${round} .matchup[data-match="${match}"] .teams`);
    if (!matchup) return;
    for (let i = 0; i < 2; i++) {
      const teamDiv = matchup.children[i];
      if (teams[i]) {
        teamDiv.textContent = `Team ${teams[i]}`;
        teamDiv.dataset.team = teams[i];
        teamDiv.classList.remove('disabled', 'selected');
      } else {
        teamDiv.textContent = 'Select Winner';
        teamDiv.dataset.team = '';
        teamDiv.classList.add('disabled');
        teamDiv.classList.remove('selected');
      }
    }
  }

  // Clear downstream selections from a given round and match
  function clearDownstream(round, match) {
    if (round === 'divisional') {
      const nextMatch = Math.ceil(match / 2);
      bracket.conference[nextMatch] = ['', ''];
      bracket.championship[1] = ['', ''];
      bracket.champion = '';
      updateMatchup('conference', 1, bracket.conference[1]);
      updateMatchup('conference', 2, bracket.conference[2]);
      updateMatchup('championship', 1, bracket.championship[1]);
      updateChampion('');
    } else if (round === 'conference') {
      bracket.championship[1] = ['', ''];
      bracket.champion = '';
      updateMatchup('championship', 1, bracket.championship[1]);
      updateChampion('');
    } else if (round === 'championship') {
      bracket.champion = '';
      updateChampion('');
    }
  }

  // Update champion display
  function updateChampion(team) {
    const champDiv = document.getElementById('champion');
    bracket.champion = team;
    if (team) {
      champDiv.textContent = `Champion: Team ${team}`;
    } else {
      champDiv.textContent = 'No Champion Selected';
    }
  }

  // Handle team click event
  function handleTeamClick(e) {
    const el = e.currentTarget;
    if (el.classList.contains('disabled')) return;

    const round = el.dataset.round;
    const match = Number(el.dataset.match);
    const team = el.dataset.team;
    const isSelected = el.classList.contains('selected');

    if (isSelected) {
      // Deselect and clear downstream
      el.classList.remove('selected');
      clearDownstream(round, match);

      if (round === 'divisional') {
        const nextMatch = Math.ceil(match / 2);
        if (bracket.conference[nextMatch].includes(team)) {
          bracket.conference[nextMatch] = bracket.conference[nextMatch].map(t => (t === team ? '' : t));
          updateMatchup('conference', nextMatch, bracket.conference[nextMatch]);
          clearDownstream('conference', nextMatch);
        }
      } else if (round === 'conference') {
        if (bracket.championship[1].includes(team)) {
          bracket.championship[1] = bracket.championship[1].map(t => (t === team ? '' : t));
          updateMatchup('championship', 1, bracket.championship[1]);
          clearDownstream('championship', 1);
        }
      } else if (round === 'championship') {
        if (bracket.champion === team) {
          updateChampion('');
        }
      }
    } else {
      // Select team, deselect siblings
      const siblings = el.parentElement.querySelectorAll('.team');
      siblings.forEach(sib => sib.classList.remove('selected'));
      el.classList.add('selected');

      if (round === 'divisional') {
        const nextMatch = Math.ceil(match / 2);
        const slot = (match % 2) === 1 ? 0 : 1;
        bracket.conference[nextMatch][slot] = team;
        updateMatchup('conference', nextMatch, bracket.conference[nextMatch]);
        clearDownstream('divisional', match);
      } else if (round === 'conference') {
        const slot = (match === 1) ? 0 : 1;
        bracket.championship[1][slot] = team;
        updateMatchup('championship', 1, bracket.championship[1]);
        clearDownstream('conference', match);
      } else if (round === 'championship') {
        updateChampion(team);
      }
    }
  }

  // Initialize event listeners and populate initial bracket
  function init() {
    for (let match = 1; match <= 4; match++) {
      updateMatchup('divisional', match, bracket.divisional[match]);
    }
    updateMatchup('conference', 1, bracket.conference[1]);
    updateMatchup('conference', 2, bracket.conference[2]);
    updateMatchup('championship', 1, bracket.championship[1]);
    updateChampion(bracket.champion);

    document.querySelectorAll('.team').forEach(teamDiv => {
      teamDiv.addEventListener('click', handleTeamClick);
    });
  }

  window.onload = init;
</script>

</body>
</html>
